{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "HF upload (1 worker)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "USE_VENV=1 SKIP_CREATE=1 REQUIRE_XET=1 CHUNK_BY=collection NUM_WORKERS=1 MAX_GET_UPLOAD_MODE_WORKERS=1 MAX_PREUPLOAD_WORKERS=1 SHA256_CACHE=rw PURGE_UPLOAD_CACHE=invalid ./scripts/ops/hf_push_cc_pointers_by_collection.sh"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: pointers-from-csv",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "PYTHONPATH=src python -m common_crawl_search_engine.cli plan pointers-from-csv -- --csv data/us_towns_and_counties_urls.csv"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: pointers-from-csv (debug 5)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "PYTHONPATH=src python -m common_crawl_search_engine.cli plan pointers-from-csv -- --csv data/us_towns_and_counties_urls.csv --domains-limit 5 --max-matches 2000 --domain-workers 4"
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: pointers-from-jsonl (state agencies)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "PYTHONPATH=src python -m common_crawl_search_engine.cli plan pointers-from-jsonl -- --jsonl artifacts/state_agencies_all.jsonl --domain-workers 12 --max-matches 0 --max-parquet-files 0 --per-parquet-limit 0"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: slices-from-pointers",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "RUN_ID=$(cat datasets/CCINDEX_WARC_CACHE_DIR/slice_indexes/LATEST.txt); P=datasets/CCINDEX_WARC_CACHE_DIR/slice_indexes/$RUN_ID/pointers.parquet; if [ ! -f \"$P\" ]; then P=datasets/CCINDEX_WARC_CACHE_DIR/slice_indexes/$RUN_ID/pointers.jsonl; fi; PYTHONPATH=src python -m common_crawl_search_engine.cli plan slices-from-pointers -- --pointers-jsonl \"$P\""
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: fetch-slices",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "PYTHONPATH=src python -m common_crawl_search_engine.cli plan fetch-slices -- --workers 32"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "CC plan: extract-from-cache",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "PYTHONPATH=src python -m common_crawl_search_engine.cli plan extract-from-cache -- --workers 16"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    }
  ]
}
